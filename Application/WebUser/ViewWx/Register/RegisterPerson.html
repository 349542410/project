<extend name="Public:base_register" />
<!-- 个人注册html -->
<html>
<!-- head -->
<block name="css">
  <!-- 表单验证提示样式css -->
  <link rel="stylesheet" href="__APPWX__/css/valstyle.css" type="text/css" media="all" />
    <!-- 密码强度 -->
    <script type="text/javascript">

        function CheckIntensity(pwd) {
            var m = 0;
            var Modes = 0;
            for (i = 0; i < pwd.length; i++) {
                var charType = 0;
                var t = pwd.charCodeAt(i);
                if (t >= 48 && t <= 57) { charType = 1; }
                else if (t >= 65 && t <= 90) { charType = 2; }
                else if (t >= 97 && t <= 122) { charType = 4; }
                else { charType = 4; }
                Modes |= charType;
            }
            for (i = 0; i < 4; i++) {
                if (Modes & 1) { m++; }
                Modes >>>= 1;
            }
            if (pwd.length <= 4) { m = 1; }
            if (pwd.length <= 0) { m = 0; }
            switch (m) {
                case 1:
                    $("#pwd_weak").show();
                    $("#pwd_medium").hide();
                    $("#pwd_strong").hide();
                    break;
                case 2:
                    $("#pwd_weak").hide();
                    $("#pwd_medium").show();
                    $("#pwd_strong").hide();
                    break;
                case 3:
                    $("#pwd_weak").hide();
                    $("#pwd_medium").hide();
                    $("#pwd_strong").show();
                    break;
            }
        }
    </script>
</block>
<!-- head end -->

<body>
<block name="banner">
    <div class="banners row">
            <div class="left col-xs-4">
                <div class="ads">
                    <p class="now">{:L('Per_r_re')}</p>
                    <p class="navleft">{:L('Welcome_re')}</p>
                </div>
            </div>
            <div class="right col-xs-8">
                <img src="__IMG__/brief_01.jpg" width="100%" height="155">
            </div>
    </div>
</block>
<block name="content">
<form method="post" action="{:U('RegisterPerson')}" id="registerform">

<div class="empty-container paddl-5">

    <!-- 顶部菜单 -->

    <div class="empty-content">
        <div class="empty-area">
            
    <div class="reg-container">
      
  <ul class="c-loginprocess">
    <li id="MainContent_RegisterProcess1_step1" class="passed">
        <p class="p1">1</p>
        <span>{:L('Completed_re')}</span>
    </li>
    <li id="MainContent_RegisterProcess1_step2" >
        <p class="p1">2</p>
        <span>{:L('Email_re')}</span>
    </li>
    <li id="MainContent_RegisterProcess1_step3">
        <p class="p1">3</p>
          <span id="MainContent_RegisterProcess1_cType">
            <if condition="$type eq 'company'">
              {:L('Complete_re_c')}
              <else />
              {:L('Complete_re_p')}
            </if>
          </span>
    </li>
    <li id="MainContent_RegisterProcess1_step4">
        <p class="p1">4</p>
        <span>{:L('Upload_re')}</span>
    </li>
    <li id="MainContent_RegisterProcess1_step5">
        <p class="p1">5</p>
        <span>{:L('Sign_re')}</span>
    </li>
    <li class="last">
        <p class="p1">6</p>
        <span>{:L('Wait_f_re')}</span>
    </li>
    <div style="clear: both;"></div>
  </ul>
        <div class="bg-white ly-pd-30 registermain" style="padding: 20% 0%;">
          <ul class="c-forms">
              <li class="ly-mg-tb-15">
                  <div class="c-forms-label">{:L('Username_re')}<span class="fc-red">*</span></div>
                  <input type="text" name="username" id="username" class="c-input-text required" />
              </li>
              <li class="ly-mg-tb-15">
                <div>
                  <div class="c-forms-label">{:L('Password_re')}<span class="fc-red">*</span></div>
                  <input name="pwd" type="password" id="pwd" class="c-input-text" onKeyUp="CheckIntensity(this.value)" />
                </div>
            </li>
            <li class="ly-mg-tb-15" style="display:none">
            <div>  
               <div class="c-password-range" id="pwd_strong" style="display:block;">
                  <span class="item"></span>
                <span class="item">强</span>
               </div> 
               <div class="c-password-range" id="pwd_medium" style="display:block;">
                  <span class="item"></span>
                <span class="item">中</span>
               </div> 
               <div class="c-password-range" id="pwd_weak" style="display:block;">
                <span class="item">弱</span>
               </div> 
              </li>
              <li class="ly-mg-tb-15">
                  <div class="c-forms-label">{:L('Passwords_re')}<span class="fc-red">*</span></div>
                  <input name="repwd" type="password" id="repwd" class="c-input-text" />
              </li>
              <li class="ly-mg-tb-15">
                  <div class="c-forms-label">{:L('Email_s_re')}<span class="fc-red">*</span></div>
                  <input name="email" type="text" id="email" class="c-input-text" />
                  <span style="color:#aaa;"></span>
              </li>
              <li id="ty" class="ly-mg-tb-15">
                  
                  <div class="c-forms-label">
                      {:L('Family_re')}<span class="fc-red">*</span>
                  </div>
                  <input name="FirstName" type="text" id="FirstName" class="c-input-text" />
                  
            </li>
              <li id="ty" class="ly-mg-tb-15">   
                  
                  <div class="c-forms-label">
                      {:L('Given_re')}<span class="fc-red">*</span>
                  </div> 
                  <input name="LastName" type="text" id="LastName" class="c-input-text" />
                
              </li>
              <li style="margin-top: 8%;">
                <div>
                  <div class="c-forms-label">{:L('Verification_re')}<span class="fc-red">*</span></div>  
                  <input name="verify" class="c-input-text" id="verify" placeholder="" type="text">
                </div>
                  
              </li>
               <li style="margin: 0;">
                <div style="line-height: 0">
                  <div class="c-forms-label"><span class="fc-red"></span></div>  
                <smap style="display: inline-block;text-align: center;width: 100%"><img width="30%" id="myverify" class="left15" height="60" alt="{:L('Verification_re')}" src="{:U('Register/verify_c',array())}" title="点击刷新" onclick="this.src='__URL__/verify_c/'+Math.round(new Date().getTime()/1000)"></smap>
                </div>    
              </li>
              <li class="ly-mg-tb-15 checkdiv">
                <div class="c-forms-label"><span class="fc-red"></span></div>  
                <label><input name="" type="checkbox" value="" id="regText" style="margin-right: 5px;">{:L('Read_Agree')}</label><br>
                <a href="{:U('ServiceAgreement')}" style="margin-left: 26%;">{:L('Agreement')}</a>
              </li>
              <li class="ly-mg-tb-15">               
                  <input type="hidden" name="ajax" value="0">
                  <input type="hidden" name="countryId" value="{$countryId}" id="countryId"> 
                  <input type="hidden" name="type" value="{$type}" id="type">
                  <smap style="display: inline-block;width: 100%;text-align: center;"><input value="{:L('Next_re')}" class="c-btn-lg-next" type="submit" id="regBtn" disabled>
                <span id="msgbox"></span>
              </li>
          </ul>
<!--            <div id="MainContent_mailValidateForm" style="display:none;" title="邮件验证">
            <iframe id="iframeForMailValidate"  style="width: 545px; height: 326px;" scrolling="no" frameborder="0" marginwidth="0" marginwidth="0"></iframe>
          </div> -->
        </div>
    </div>

        </div>
    </div>

    <!-- footer -->

</div>

</form>
<!-- 必须 -->
<script type="text/javascript" src="__PUBLIC__/js/Validform_v5.3.2_min.js"></script>
<script src="__JS__/jquery.form.js"></script>

<style>
#msgbox{font-weight:bold;color:#FB0000;}
</style>
<script language="JavaScript">
// 服务协议
$(document).ready(function() {
  var regBtn = $("#regBtn");
  $("#regText").change(function() {
    var that = $(this);
    that.prop("checked", that.prop("checked"));
    if (that.prop("checked")) {
      regBtn.prop("disabled", false)
    } else {
      regBtn.prop("disabled", true)
    }
  });
});
// 发送邮件成功后的页面跳转动画
jQuery(document).ready(function($){
    $('#registerform').ajaxForm({
        beforeSend:function(){
  $("#msgbox").html('&nbsp;<img style="width:20px;height:20px;" src="__PUBLIC__/images/msg_loading_d.gif"/>');
  var demo=$("#registerform").Validform({
    tiptype:3,
    label:".label",
    showAllError:true,
    datatype:{
      "zh1-6":/^[\u4E00-\u9FA5\uf900-\ufa2d]{1,6}$/
    },
    ajaxPost:false
  });
  demo.addRule([
      {
          ele:"#username",
          datatype:"s6-18",
          ajaxurl:"{:U('Register/checkname')}",
          nullmsg:"{:L('Please_nickname_re')}",
          errormsg:"{:L('Nickname_le_re')}"
      },
      {
          ele:"#pwd",
          datatype:"*6-16",
          nullmsg:"{:L('Please_password_re')}",
          errormsg:"{:L('Password_le_re')}"
      },
      {
          ele:"#repwd",
          datatype:"*6-16",
          recheck:"pwd",
          nullmsg:"{:L('Please_en_re')}",
          errormsg:"{:L('You_two_re')}"
      },
      {
          ele:"#email",
          datatype:"e",
          ajaxurl:"{:U('Register/checkemail')}",
          nullmsg:"{:L('Please_e_re')}",
          erormsg:"{:L('Email_ree_re')}"
      },
      {
          ele:"#FirstName",
          datatype:"s",
          nullmsg:"{:L('Pleas_nc_re')}",
          errormsg:"{:L('Length_10_re')}"
      },
      {
          ele:"#LastName",
          datatype:"s",
          nullmsg:"{:L('Please_name_re')}",
          errormsg:"{:L('Length_10_re')}"
      },
      // {
      //     ele:"#verify",
      //     datatype:"n",
      //     // ajaxurl:"{:U('Register/checkverify')}",
      //     nullmsg:"请输入验证码！",
      //     errormsg:""
      // }
  ]);
         },
        success: complete,  //成功则执行complete函数
        dataType: 'json',
    });
});
function complete(data){
    if (data.status==true){
        $('#msgbox').html('<span style="font-size:15px;padding-left:10px;color:green;">'+data.info+'</span>').fadeIn(300).delay(1000).fadeOut(300,function(){
            window.location.href="{:U(CONTROLLER_NAME.'/ensure')}";
        });
      
    }else{
        $('#msgbox').html('<span style="font-size:15px;padding-left:10px;color:red;">'+data.info+'</span>').fadeIn(300).delay(1000).fadeOut(300,function(){
            if(data.info == '验证码错误'){
              $('#myverify').click();                //模拟用户点击刷新验证码
            }
        });
    }
}

// window.onunload = function() {  
//    return "您输入的数据可能不会被保存，确定继续吗?";
// } 
// window.onbeforeunload = function(){
//     return "您输入的数据可能不会被保存，确定继续吗?";
// }
 
</script>          
</block>
</body>
</html>
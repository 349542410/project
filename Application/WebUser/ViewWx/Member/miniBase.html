<!-- 公共内容 -->
<div class="cont" style="margin-bottom:0;margin-top:0;">
	<div class="messg">
	<volist name="list" id="vo" mod="2">
		<ul>
			<li>
			<if condition="(I('get.type','index') eq 'index')">
				<p class="fleft mslp">{:L('OrderSNumber')}:{$vo['order_no']}</p>
				<p class="frig msrp">待处理</p>
			</if>
			<if condition="(I('get.type','index') neq 'index')">
				<p class="fleft mslp">{:L('OddNumbers')}:{$vo['MKNO']}</p>
			</if>
				
				<div style="clear: both;"></div>
			</li>
			<li>
				<div align="center" class="midcont">
					<h5 class="fleft mslh5"></h5><h6 class="fleft">{$vo['sender']}</h6>
					<img src="__APPWX__/images/yuns_icon.png">
					<h6 class="frig">{$vo['receiver']}</h6>
				</div>
				<div style="clear: both;"></div>
			</li>
			<if condition="(I('get.type','index') eq 'transport')">
			<li>
				<div class="trans">
					<h4>{:L('LogisticsNewInfo')}</h4>
					<div class="trancont">
						{$vo['content']}
					</div>
				</div>	
			</li>
			</if>
			<li class="lastbr">
				<div class="frig midtbox">
				<if condition="(I('get.type','index') eq 'index')">
					<a href="javascript:;" onclick="javascript:window.location.href='{:U('Order/step_three',array('cid'=>$vo['id'],'cname'=>CONTROLLER_NAME))}';">{:L('PrintRandomCode')}</a>
				</if>
				</div>
			</li>
			<li>
				<div class="lastcont">
				<if condition="(I('get.type','index') eq 'index')">
					<p class="fleft">{$vo['ctime']} </p>
				</if>
					<div class="lastca frig">
						<!-- 查看 -->
						<a href="javascript:;" onclick="showinfo(this);" id="{$vo['id']}">{:L('CheckOut')}</a> <!-- 使用layer方法 -->
						<if condition="(I('get.type','index') eq 'index')">
							<if condition="$vo['auto_Indent1'] && $vo['auto_Indent1'] != ''">

								<span style="vertical-align:text-middle;">&minus;</span> 
								<a href="{:U('Order/newOrder',array('id'=>$vo['id']))}">{:L('OrderAgain')}</a>

							<else />

								<if condition="$vo['pay_state'] neq '1'">
								 	<span style="vertical-align:text-middle;">&minus;</span> 
									<!-- 修改 -->
									<a href="javascript:void;" onclick="javascript:window.location.href='{:U('Order/edit',array('id'=>$vo['id']))}';">{:L('Modify')}</a>
								 	<span style="vertical-align:text-middle;">&minus;</span> 
									<!-- 删除 -->
								 	<a href="javascript:void;" onclick="del('{$vo.id}','{:U('Member/delete')}')">{:L('Delete')}</a>
								 	<span style="vertical-align:text-middle;">&minus;</span> 
									<!-- 再次下单 -->
									<a href="{:U('Order/newOrder',array('Q_no'=>$vo['order_no'],'id'=>$vo['id']))}">{:L('OrderAgain')}</a>
								</if>
							</if>

						<elseif condition="(I('get.type','index') neq 'index')"/>

						 	<span style="vertical-align:text-middle;">&minus;</span> 
							<!-- 再次下单 -->
							<a href="{:U('Order/newOrder',array('id'=>$vo['id']))}">{:L('OrderAgain')}</a>
										
						</if>
					</div>
				</div>
			</li>
		</ul>
		</volist>
	</div>
</div>
<!-- 20170314 修改弹出框，使用layer 甘-->
<script type="text/javascript">
	// 查看单
	function showinfo(obj){
		var id = obj.id;
		layer.open({
			  type: 2,
			  shadeClose: true,
			  title: false,
			  scrollbar: false,
			  resize: false,
			  area : ['95%' , '95%'],
			  btn: ["{:L('ToClose')}"],
			  closeBtn: 0,
			  skin: 'demo-class',//自定义样式demo-class
			  offset: '20px',
			  content: "{:U( 'Member/info',array( 'type'=>I('get.type','index') ) )}?id="+id
			  // content:'<iframe src="'+"{:U( 'Member/info',array( 'type'=>I('get.type','index') ) )}?id="+id+'"  width="100%"  height="500px"></iframe>'
			  });
	}
	// 删除前的确认框
	function del(id,url)
	{
		layer.confirm("{:L('LAY_MesDel')}", {icon:3,offset: '200px',title: "{:L('LAY_Information')}",btn: ["{:L('LAY_BtnOK')}", "{:L('LAY_BtnCancel')}"]}, function(){
			$.ajax({
				url: url,
				type: "POST",
				data:{"id":id},
				dataType: "json",
				success: function(data){
					if(data.state=='yes'){
						layer.msg(data.msg, {icon: 6});
						location.href = location.href;
					}else{
						layer.msg(data.msg, {icon: 5});
					}
				}
			});
		});
	}
</script>
<!-- END -->
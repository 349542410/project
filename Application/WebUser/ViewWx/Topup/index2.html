<!-- 在线下单 -->
<extend name="Member/base" />


<block name="main">
<script type="text/javascript" src="__MEMBER__/js/city/jquery.js"></script>
<script type="text/javascript" src="__MEMBER__/js/city/area.js"></script>
<script type="text/javascript" src="__MEMBER__/js/city/location.js"></script>
<script type="text/javascript" src="__MEMBER__/js/city/select2.js"></script>
<script type="text/javascript" src="__MEMBER__/js/city/select2_locale_zh-CN.js"></script>
<script src="__MEMBER__/js/cityselected.js"></script>
<link href="__MEMBER__/css/select2.css" rel="stylesheet"/>
<!-- <link href="__MEMBER__/css/one.css" rel="stylesheet">
<script src="__MEMBER__/js/add.js"></script> -->
<!-- <script type="text/javascript" src="__MEMBER__/js/city/city.js"></script>
<script type="text/javascript" src="__MEMBER__/js/city/edit.js"></script>-->
<style>
	h3{margin:0;padding:0;}
	#content{padding-bottom: 20px !important;}
	label{margin: 0 ;padding: 0;    white-space: nowrap;}
	.ordtop{width: 1000px;height: 450px;border:1px solid #000;margin: 20px auto;}
	.ordtop .ordsender{float: left;width:1000px;margin:20px 0px;padding: 0px 250px;}
	.ordtop .ordsender h4,.ordtop .ordrec h4{font-weight: bold;}
	.ordtop .ordsender ul,.ordtop .ordrec ul{margin-top: 30px;}
	.ordsender ul{position: relative;}
	.ordtop .ordsender .toplis{border:1px solid #000;border-radius:9px;padding-left:40px;height: 42px;line-height: 40px;margin-top: 20px;width: 280px;}
	.ordtop .ordsender input,.ordtop .ordrec input{border:none;outline: none;margin-left: 5px;}
	.ordtop .ordrec{float: left;width:498px;margin:20px 0px;padding: 0px 50px;}
	.ordtop .ordrec li{border:1px solid #000;border-radius:9px;padding-left:40px;height: 42px;line-height: 40px;margin-top: 20px;width: 400px;}
	.ordtop .ordsender .litext{border:1px solid #000;border-radius:9px;padding-left:40px;height: 155px;margin-top: 20px;width: 400px;}
	.ordhead{margin:0px auto;width: 1000px;height: 50px;background: #232323;color:#fff;text-align:center;}
	.ordtop .ordsender .litext textarea{width: 300px;height: 150px;border:none;}
	.ordhead h3{line-height: 50px;}
	.ordbody{margin:25px auto;width: 1000px;}
	.inuls li{float: left;margin-left: 20px;}
	.widen{width: 89px;line-height: 5px;background-color: #232323;border-color: #232323;color: #ffde00;height: 35px;font-size: 16px;}
	.showsp{position: absolute;top: 10px;left: 290px;}
	.litext textarea{resize: none;}
</style>
	<div class="form form_index" >
	    <div class="form-signin" style="width:100%;min-height:500px;margin:0 auto;padding:0;">
		    <form action="{:U('Topup/forsuccess')}" method="post" class="form-inline" id="tempForm">
			    <div class="ordtop">
			    	<!-- **************************************************** -->
		    		<!-- 寄件人信息 -->
			    	<div class="ordsender">
			    		<h4>充值中心</h4>
			    		<ul>
			    			<li class="toplis"><label>金额：</label><input type="text" value="" name="amount" id="angelweb" maxlength="6" placeholder="请输入整数或小数二位">元</li><span class="showsp" id="out"></span>
			    			<li class="litext"><label>备注：</label><textarea name="note" value="" placeholder="请输入备注"></textarea></li>
			    		</ul>
			    		<div class="inuls">
			    			<label>支付方式：</label>
			    			<ul>
			    				<li><input type="radio" name="paykind" value="支付宝">支付宝</li>
			    				<li><input type="radio" name="paykind" value="微信">微信</li>
			    				<li><input type="radio" name="paykind" value="财付通">财付通</li>
			    			</ul>
			    		</div>
			    	</div>
			    	<div class="clear"></div>
				<table style="width: 1000px;float: right;margin: 0 auto;margin-top: 70px;">
					<tr>
						<td>
							<input type="hidden" value="{$user_id}" name="UID">
						</td>
						<td style="text-align: right;">
							<span id="loading" style="bottom:180px;left:650px !important;"></span>
							<button type="button" class="widen" id="BtnSave">提交充值</button>
							<!-- <button type="button" class="btn btn-default" data-dismiss="modal" id="beClosed">关闭</button> -->
							<span id="messagebox" class="msgbox" style="bottom:180px;left:650px !important"></span>					
						</td>
					</tr>
				</table>
			</form>
	    </div>
   	</div>
   	<script type="text/javascript">
   	$('#angelweb').blur(function(){
   		var num=$("#angelweb").val();
   		if(isNaN(num)){
   			alert("您输入的不是数字，请重新输入！");
   			return false;
   		}
   		var o=jqNumToMoney(num);
		$("#out").text(o);
   	});

   	function jqNumToMoney(n){
   		var fraction = ['角','分'];
   		var digit 	 = ['零','壹','贰','叁','肆','伍','陆','柒','捌','玖'];
   		var unit     = [['元','万','亿'],['','拾','佰','仟']];
   		var head     = n < 0?'欠':'';
   		n = Math.abs(n);
   		var s = '';
	   	for (var i = 0; i < fraction.length; i++) {  
			s += (digit[Math.floor(n * 10 * Math.pow(10, i)) % 10] + fraction[i]).replace(/零./, '');
		}
		s = s || '整';
		n = Math.floor(n);
		for (var i = 0; i < unit[0].length && n > 0; i++) {
			var p = '';
			for (var j = 0; j < unit[1].length && n > 0; j++) {
				p = digit[n % 10] + unit[1][j] + p;
				n = Math.floor(n / 10);
			}
			s = p.replace(/(零.)*零$/, '').replace(/^$/, '零') + unit[0][i] + s;
		}
		return head + s.replace(/(零.)*零元/,'元').replace(/(零.)+/g, '零').replace(/^整$/, '零元整');
   	}

   	$('#BtnSave').click(function(){
	    $.ajax({
	        cache: false,
	        type: "post",
	        url:"{:U('Topup/checkForm')}",
	        data:$('#tempForm').serialize(),// 你的formid
	        async: false,
	        beforeSend:function(){
	            $("#loading").html('<img style="width:28px;height:28px;" src="__MEMBER__/images/msg_loading_d.gif"/>');
	        },
	        error: function(request) {
	            layer.alert("Connection error");
	        },
	        success: function(data) {
	            if(data.state == 'no'){
					layer.open({
						type: 0,
						offset: '300px',
						shadeClose: true,
						title: "{:L('LAY_SystemMessage')}",
						content : data.msg,
						icon : 5,
					});
	                  $("#loading").html('');
	            }else{
	                $('#BtnSave').attr('type','submit');
	            }
	        }
	    });
    });
   	</script>
	<div class="foot"></div>

</block>

</body>
</html>
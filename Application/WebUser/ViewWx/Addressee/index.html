<!-- 收件人信息管理 -->
<extend name="Member/base" />


<block name="main">
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="__MEMBER__/css/magiczoomplus.css">
<link rel="stylesheet" type="text/css" href="__MEMBER__/css/addr_index.css">
<script type="text/javascript" src="__MEMBER__/js/city/jquery.js"></script>
<script type="text/javascript" src="__MEMBER__/js/magiczoomplus.js"></script>
<script> var mzOptions = { textHoverZoomHint: "", textClickZoomHint: "", textExpandHint: "", textBtnClose: "", textBtnNext: "", textBtnPrev: "", selectorTrigger: "hover",zoomWidth: 500, zoomHeight: 400,zoomMode: "preview" , zoomPosition: "right" }; </script>
<div class="ordhead" style="width: 1710px;margin-bottom: 20px;"><h3>{:L('l_recipient')}</h3></div>
<div class="mt">
    <a href="javascript:;" class="add-btn" onclick="showinfo(this)">{:L('l_add_recipient')}</a>
</div>
<!-- 公共内容 --> 
<form action="" style="min-height:600px;">
    <div class="container" style="margin-bottom:0;margin-top:0;">
                <table width="100%" border="0" cellpadding="10" cellspacing="10"  class="table table-hover">
                    <thead>
                        <tr class="hiddenf">
                            <!-- 序号 -->
                            <th class="width90">{:L('OrderNum')}</th>
                            <!-- 审核状态 -->
                            <th>{:L('l_audit_status')}</th>
                            <!-- 收件人 -->
                            <th class="hiddenf width90">{:L('AddressRec')}</th>
                            <!-- 中转线路 -->
                            <th>{:L('TranLine')}</th>
                            <!-- 身份证号码 -->
                            <th>{:L('l_cer_num')}</th>
                            <!-- 身份证正面 -->
                            <th>{:L('l_cer_fc')}</th>
                            <!-- 身份证反面 -->
                            <th>{:L('l_cer_bc')}</th>
                            <!-- 创建时间 -->
                            <th>{:L('Createtime')}</th>
                            <!-- 操作 -->
                            <th>{:L('Operation')}</th>
                        </tr>
                    </thead>
                    <tbody>
                        <volist name="data" id="vo">
                            <tr id="tr_{$vo.id}" <eq name="mod" value="0"> style="background-color:#f4f4f4;"</eq> >
                                <!-- 序号 -->
                                <td class="width90">
                                    {$key+1}
                                </td>     
                                <td> 
                                <if condition="$vo.status eq 0">
                                    <img src="__MEMBER__/image/info.png" title="{:L('l_not_audited')}">
                                <elseif condition="$vo.status eq 2" />
                                    <img src="__MEMBER__/image/error.png" title="{:L('l_not_approved')}">
                                <else/>
                                    <img src="__MEMBER__/image/right.png" title="{:L('l_audit_passed')}">
                                </if>
                                    
                                </td>             
                                <!-- 收件人 -->
                                <td class="hiddenf width90 txt">
                                    <span>{$vo['name']}</span>
                                    <div class="prompt-01 prompt-02">
                                        <div class="pc">
                                            <strong>{$vo['name']}</strong>
                                            <p>{$vo['province']}{$vo['city']}{$vo['town']}{$vo['address']}</p>
                                            <p>{$vo['tel']}</p>
                                        </div>
                                        <div class="p-arrow p-arrow-left"></div>
                                    </div>
                                </td>
                                <!-- 中转路线 -->
                                <td>
                                    <php>$l = L('MKLINES');echo $l[$vo['lngname']];</php>
                                </td>
                                <!-- 身份证号码 -->
                                <td>
                                    {$vo['cre_num']}
                                </td>
                                <!-- 身份证正面 -->
                                <td>
                                <a href="{$vo['id_card_front']}" class="MagicZoom" rel="zoom-position:top;"><img src="{$vo['id_card_front_small']}"/></a>
<!--                                     <img src="{$vo['id_card_front']}" style="width: 150px;height: 90px;"> -->
                                </td>
                                <!-- 身份证反面 -->
                                <td>
                                    <a href="{$vo['id_card_back']}" class="MagicZoom"><img src="{$vo['id_card_back_small']}"/></a>
<!--                                     <img src="{$vo['id_card_back']}" style="width: 150px;height: 90px;"> -->
                                </td>
                                <td>
                                    <!-- 创建时间 -->
                                    {$vo['sys_time']}
                                </td>
                                <td style="text-align:center; position: relative;">
                                    <!-- 修改 -->
                                    <a href="javascript:void(0);" onclick="saveinfo(this);" id="{$vo['id']}">{:L('Modify')}</a>
                                     <span style="vertical-align:text-middle;">|</span> 
                                    <!-- 删除 -->
                                     <a href="javascript:void(0);" onclick="del('{$vo.id}','{:U('Addressee/deleteAddressee')}')">{:L('Delete')}</a>
                                    <!-- End -->
                                </td>
                            </tr>
                        </volist>
                    </tbody>                        
                </table>
    </div>
</form>
<!-- 20170314 修改弹出框，使用layer 甘-->
<script type="text/javascript">
    $(function(){
        $(".txt").hover(function (){  
            $(this).find('.prompt-02').show();  
        },function (){  
            $(this).find('.prompt-02').hide();  
        });  
    });
    // 添加收件人信息
    function showinfo(obj){
    var ta1 = layer.open({
              type: 2,
              shadeClose: false,
              title: "{:L('l_add_recipient')}",
              area : ['800px' , '870px'],
              scrollbar: false,
              resize: false,
              offset: '5%',
              content: "{:U( 'Addressee/addressee')}",
                success: function(layero, index){
                    this.enterEsc = function(event){
                        if(event.keyCode === 13){
                            layer.closeAll();
                            return false; //阻止系统默认回车事件
                        }
                    };
                    $(document).on('keydown', this.enterEsc);
                    //监听键盘事件，关闭层
                },
        });
    }
    // 编辑收件人信息
    function saveinfo(obj){
        var id = obj.id;
        layer.open({
              type: 2,
              shadeClose: false,
              title: "{:L('l_edit_ri')}",
              area : ['800px' , '870px'],
              scrollbar: false,
              resize: false,
              offset: '5%',
              content: "{:U( 'Addressee/saveressee')}?id="+id,
                success: function(layero, index){
                    this.enterEsc = function(event){
                        if(event.keyCode === 13){
                            layer.closeAll();
                            return false; //阻止系统默认回车事件
                        }
                    };
                    $(document).on('keydown', this.enterEsc);
                    //监听键盘事件，关闭层
                }
        });
    }
    // 删除前的确认框
    function del(id,url)
    {
        layer.confirm("{:L('LAY_MesDel')}", {icon:3,offset: '400px',title: "{:L('LAY_Information')}",btn: ["{:L('LAY_BtnOK')}", "{:L('LAY_BtnCancel')}"]}, function(){
            $.ajax({
                url: url,
                type: "POST",
                data:{"id":id},
                dataType: "json",
                success: function(data){
                    if(data.state=='yes'){
                        layer.msg(data.msg, {icon: 6,offset: '400px'});
                        location.href = location.href;
                    }else{
                        layer.msg(data.msg, {icon: 5,offset: '400px'});
                    }
                }
            });
        });
    }
</script>
<div id="pages" class="page" style="margin-bottom: 100px;">{$page}</div>
<div class="foot"></div>

</block>

</body>
</html>
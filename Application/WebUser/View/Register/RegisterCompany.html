<extend name="Public:base_register" />
<!-- 企业注册html -->
<html>
<!-- head -->
<block name="css">
  <!-- 表单验证提示样式css -->
  <link rel="stylesheet" href="__MEMBER__/css/style.css" type="text/css" media="all" />
  <style>
    .my-dialog .ui-dialog-titlebar-close {
      display: none;
    }
  </style>
  <script type="text/javascript">
    $(function () {
      $('#registerform').validationEngine('attach', {
        promptPosition: 'centerRight',
        scroll: false
      });
    });

    function CheckIntensity(pwd) {
      var m = 0;
      var Modes = 0;
      for (i = 0; i < pwd.length; i++) {
        var charType = 0;
        var t = pwd.charCodeAt(i);
        if (t >= 48 && t <= 57) {
          charType = 1;
        } else if (t >= 65 && t <= 90) {
          charType = 2;
        } else if (t >= 97 && t <= 122) {
          charType = 4;
        } else {
          charType = 4;
        }
        Modes |= charType;
      }
      for (i = 0; i < 4; i++) {
        if (Modes & 1) {
          m++;
        }
        Modes >>>= 1;
      }
      if (pwd.length <= 4) {
        m = 1;
      }
      if (pwd.length <= 0) {
        m = 0;
      }
      switch (m) {
        case 1:
          $("#pwd_weak").show();
          $("#pwd_medium").hide();
          $("#pwd_strong").hide();
          break;
        case 2:
          $("#pwd_weak").hide();
          $("#pwd_medium").show();
          $("#pwd_strong").hide();
          break;
        case 3:
          $("#pwd_weak").hide();
          $("#pwd_medium").hide();
          $("#pwd_strong").show();
          break;
      }
    }
  </script>
</block>
<!-- head end -->

<body>
  <block name="banner">
    <div class="banners">
      <div class="left">
        <div class="ads">
          <p class="now">{:L('Company_Register_en')}</p>
          <p class="navleft">{:L('Welcome_to_en')}</p>
        </div>
      </div>
      <div class="right">
        <img src="__IMG__/brief_01.jpg" width="100%" height="155">
      </div>
    </div>
  </block>
  <block name="content">
    <form method="post" action="{:U('RegisterCompany')}" class="registerform" id="registerform">



      <div class="empty-container">

        <!-- 顶部菜单 -->

        <div class="empty-content">
          <div class="empty-area">

            <div class="reg-container">

              <ul class="c-loginprocess">
                <li id="MainContent_RegisterProcess1_step1" class="passed">
                  <p class="p1">1</p>
                  <span>{:L('Completed_re')}</span>
                </li>
                <li id="MainContent_RegisterProcess1_step2">
                  <p class="p1">2</p>
                  <span>{:L('Email_re')}</span>
                </li>
                <li id="MainContent_RegisterProcess1_step3">
                  <p class="p1">3</p>
                  <span id="MainContent_RegisterProcess1_cType">
                    <if condition="$type eq 'company'">
                      {:L('Complete_re_c')}
                      <else /> {:L('Complete_re_p')}
                    </if>
                  </span>
                </li>
                <li id="MainContent_RegisterProcess1_step4">
                  <p class="p1">4</p>
                  <span>{:L('Upload_re')}</span>
                </li>
                <li id="MainContent_RegisterProcess1_step5">
                  <p class="p1">5</p>
                  <span>{:L('Sign_re')}</span>
                </li>
                <li class="last">
                  <p class="p1">6</p>
                  <span>{:L('Wait_f_re')}</span>
                </li>
                <div style="clear: both;"></div>
              </ul>
              <div class="bg-white ly-pd-30 registermain" style="padding: 50px 0px 50px 0;">
                <span id="MainContent_lMsg" style="color:Red;"> </span>
                <h2 class="fc-yel"></h2>
                <div class="fc-999 ly-pd-tb-5"></div>
                <ul class="c-forms">
                  <li class="ly-mg-tb-15">
                    <div class="c-forms-label">{:L('Username_re')}
                      <span class="fc-red">*</span>
                    </div>
                    <input type="text" name="username" id="username" class="c-input-text mt_text validate[required,minSize[6],maxSize[18],custom[onlyLetterNumber]]"
                      maxlength="20" />
                  </li>
                  <li class="ly-mg-tb-15" style="">
                    <div>
                      <div class="c-forms-label">{:L('Password_re')}
                        <span class="fc-red">*</span>
                      </div>
                      <input name="pwd" type="password" id="pwd" class="c-input-text mt_text validate[required,minSize[6],maxSize[16]]" onKeyUp="CheckIntensity(this.value)"
                      />
                    </div>
                  </li>
                  <li class="ly-mg-tb-15" style="height:60px;display:none">
                    <div class="c-password-range" id="pwd_strong" style="display:none;">
                      <span class="item"></span>
                      <span class="item">强</span>
                    </div>
                    <div class="c-password-range" id="pwd_medium" style="display:none;">
                      <span class="item"></span>
                      <span class="item">中</span>
                    </div>
                    <div class="c-password-range" id="pwd_weak" style="display:none;">
                      <span class="item">弱</span>
                    </div>
                  </li>
                  <li class="ly-mg-tb-15">
                    <div class="c-forms-label">{:L('Passwords_re')}
                      <span class="fc-red">*</span>
                    </div>
                    <input name="repwd" type="password" id="repwd" class="c-input-text mt_text validate[required,minSize[6],maxSize[16]]" />
                  </li>
                  <li class="ly-mg-tb-15">
                    <div class="c-forms-label">{:L('Email_s_re')}
                      <span class="fc-red">*</span>
                    </div>
                    <input name="email" type="text" id="emails" class="c-input-text mt_text validate[required,custom[email]" />
                    <span style="color:#aaa;"></span>
                  </li>
                  <li class="ly-mg-tb-15">
                    <div class="c-forms-label">{:L('Com_name_re')}
                      <span class="fc-red">*</span>
                    </div>
                    <input name="companyname" type="text" id="companyname" class="c-input-text mt_text validate[required]" maxlength="30" />
                  </li>
                  <li class="ly-mg-tb-15">
                    <div>
                      <div class="c-forms-label">{:L('Verification_re')}
                        <span class="fc-red">*</span>
                      </div>
                      <input name="verify" class="c-input-text mt_text validate[required]" id="verify" placeholder="" type="text">
                    </div>

                  </li>
                  <li class="ly-mg-tb-15" style="height:80px;">
                    <div style="padding:10px 0; ">
                      <div class="c-forms-label">
                        <span class="fc-red"></span>
                      </div>
                      <smap style="display: inline-block;  width: 450px;    text-align: left;">
                        <img width="150" id="myverify" class="left15" height="60" alt="{:L('Verification_re')}" src="{:U('Register/verify_c',array())}"
                          title="点击刷新" onclick="this.src='__URL__/verify_c/'+Math.round(new Date().getTime()/1000)">
                      </smap>
                    </div>
                  </li>
                  <li class="ly-mg-tb-15 checkdiv">
                    <div class="c-forms-label">
                      <span class="fc-red"></span>
                    </div>
                    <label>
                      <input name="" type="checkbox" value="" id="regText" style="margin-right: 5px;">{:L('Read_Agree')}</label>
                    <a href="{:U('ServiceAgreement')}">{:L('Agreement')}</a>
                  </li>
                  <li class="ly-mg-tb-15">
                    <div class="c-forms-label">
                      <span class="fc-red"></span>
                    </div>

                    <input type="hidden" name="ajax" value="0">
                    <input type="hidden" name="countryId" value="{$countryId}" id="countryId">
                    <input type="hidden" name="type" value="{$type}" id="type">
                    <smap style="display: inline-block;  width: 450px;    text-align: left;">
                      <input value="{:L('Next_re')}" class="c-btn-lg-next" disabled type="submit" id="MainContent_btnNextStep">
                    </smap>
                  </li>
                  <li>
                    <div class="c-forms-label">
                      <span class="fc-red"></span>
                    </div>
                    <span id="msgbox"></span>
                  </li>
                </ul>
                <!--        <div id="MainContent_mailValidateForm" style="display:none;" title="邮件验证">
        <iframe id="iframeForMailValidate"  style="width: 545px; height: 326px;" scrolling="no"  frameborder="0" marginwidth="0" marginwidth="0"></iframe>
      </div> -->
              </div>
            </div>

          </div>
        </div>

        <!-- footer -->

      </div>

    </form>
    <!-- 必须 -->
    <script src="__JS__/jquery.form.js"></script>

    <style>
      #msgbox {
        font-weight: bold;
        color: #FB0000;
      }
    </style>
    <script language="JavaScript">
      // 服务协议
      $(function () {
        var $cr = $("#regText");
        var cr = $cr[0];
        var regBtn = $("#MainContent_btnNextStep");
        if (cr.checked) {
          regBtn.prop("disabled", false)
        } else {
          regBtn.prop("disabled", true)
        }
        $cr.click(function () {
          if (cr.checked) {
            regBtn.prop("disabled", false)
          } else {
            regBtn.prop("disabled", true)
          }
        });
      });
      // 验证码刷新生成  
      $(document).ready(function () {
        var captcha_img = $('#captcha-container').find('img')
        var verifyimg = captcha_img.attr("src");
        captcha_img.attr('title', '点击刷新');
        captcha_img.click(function () {
          if (verifyimg.indexOf('?') > 0) {
            $(this).attr("src", verifyimg + '&random=' + Math.random());
          } else {
            $(this).attr("src", verifyimg.replace(/\?.*$/, '') + '?' + Math.random());
          }
        });
      });
      // 发送邮件成功后的页面跳转动画
      jQuery(document).ready(function ($) {
        $('#registerform').ajaxForm({
          beforeSend: function () {
            $("#msgbox").html(
              '&nbsp;<img style="width:20px;height:20px;" src="__PUBLIC__/images/msg_loading_d.gif"/>');
          },
          success: complete,
          //成功则执行complete函数
          dataType: 'json',
        });
      });

      function complete(data) {
        console.log(data);
        if (data.status == true) {
          $('#MainContent_btnNextStep').prop("disabled", true);
          $('.c-btn-lg-next[disabled]').css({
            "background": "#c1832f",
            "color": "#fff",
            "border": "#1832f"
          });
          $('#msgbox').html('<span style="font-size:15px;padding-left:10px;color:green;">' + data.info + '</span>').fadeIn(
            300).delay(1000).fadeOut(300, function () {
            window.location.href = "{:U(CONTROLLER_NAME.'/ensure')}";
          });

        } else {
          $('#MainContent_btnNextStep').prop("disabled", false);
          $('#myverify').click(); //模拟用户点击刷新验证码
          $('.c-btn-lg-next[disabled]').css({
            "background": "#c1832f",
            "color": "#fff",
            "border": "#1832f"
          });
          $('#msgbox').html('<span style="font-size:15px;padding-left:10px;color:red;">' + data.info + '</span>').fadeIn(
            300).delay(1000).fadeOut(300);
        }
      }
    </script>
  </block>
</body>

</html>
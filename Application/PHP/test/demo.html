<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <style type="text/css">
      body {
        padding-top: 40px;
        padding-bottom: 40px;
        background-color: #f5f5f5;

      }

      .container{margin:0 auto;}
      .form-signin {
        max-width: 900px;
        margin-top:60px;
        background-color: #fff;
        border: 1px solid #e5e5e5;
        -webkit-border-radius: 5px;
           -moz-border-radius: 5px;
                border-radius: 5px;
        -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
           -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
                box-shadow: 0 1px 2px rgba(0,0,0,.05);
      }
    .form-signin table th{height:36px;font-size:16px;line-height:36px;background:#F7F7F9;}
    .form-signin table td{height:36px;line-height:36px;font-size:14px;text-indent:2em;background:#F7F7F9;}
    .form-signin table td a{text-decoration:none;color:#000;}
    .form-signin table td a:hover{color:blue;}
    .form-signin .form-control{width:400px !important;}
    .form-signin input{display:inline-block;}
    .form-signin .check_list{font-size:16px;}
    </style>
    <link href="__PUBLIC__/css/one.css" rel="stylesheet">
    <script src="__PUBLIC__/js/jquery-1.9.1.min.js"></script> 
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//cdnjs.bootcss.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->
     </head>
  <body>

    <div class="container" >
      <div class="form-signin" style="padding-top:40px;background:#F7F7F9 !important;margin-bottom:40px;margin: 0 auto;">

      <form action="test5.php" method="post" class="form-inline" id="excel_runimport" name="excel_runimport" enctype="multipart/form-data">
          <table border="0" cellpadding="0" cellspacing="0" class="table" style="margin-bottom:0px;padding:0px">

        <tr>
        <th>请选择要导入的CSV文件：</th>
          <td>
            <input type="file" name="file" value="" id="file_stu" multiple="multiple" required />
            转接快递：<select name="tran_type">
              <option value="ems">EMS</option>
            </select>
          </td>

        </tr>
        <tr>
          <td><input type="checkbox" name="sure_post" id="sure_post"><label for="sure_post" >&nbsp;是否推送给物流信息服务商&nbsp;(勾选即执行推送)</label></td>
        </tr>
        <tr>
          <td><input type="checkbox" name="force_kd100" id="force_kd100"><label for="force_kd100" >&nbsp;强制推送给物流信息服务商</label></td>
        </tr>
        <tr>
          <td><input type="checkbox" name="force_erp" id="force_erp"><label for="force_erp" >&nbsp;强制推送给ERP</label></td>
        </tr>
<!--         <tr>
          <td>注意：“强制”，即表示无视数据表已有的完成状态，重新获取数据，此操作将会覆盖原有数据</td>
        </tr> -->
        <tr>
              <th  colspan="3" style="text-align:left !important;padding-left:580px">
                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button type="submit" class="btn btn-primary" id="BtnSave">提交</button>
                <button type="button" class="btn btn-default" data-dismiss="modal" id="beClosed" onclick="if(confirm('确定要关闭？')){window.close();}">关闭页面</button>
                <span id="messagebox" class="msgbox" style="right:819px !important;top:167px;"></span>
              </th>
            </tr>
          
          </table>
      </form>

      </div>
    </div> 
<script type="text/javascript">
  $('#force_kd100').click(function(){
    var force_kd100 = $('#force_kd100').is(':checked');
    if(force_kd100 === true){
      $('#sure_post').prop("checked",true);
    }else{
      $('#sure_post').prop("checked",false);
    }
  })

</script>
  </body>
<script src="__PUBLIC__/js/jquery.form.js"></script>
<script>

$(function(){
  var options = { 
    timeout: 0, //限制请求的时间，当请求大于3秒后，跳出请求 
  }
  $('#excel_runimport').ajaxForm({
    beforeSubmit: checkForm, 
    success: complete,
    error: error,
    dataType: 'json',
    timeout : 0,// 代表永不超时
  });
  
  function checkForm(){
    $("#messagebox").html('<img style="width:20px;height:20px;" src="__PUBLIC__/images/msg_loading_d.gif"/>操作中...');
    if( '' == $.trim($('#file_stu').val())){
      alert('上传文件不能为空');
      return false;
    }
  }
  function complete(result){
    if(result.status == 1){
      $('#messagebox').html('<font style="color:green;font-size:16px;">'+result.msg+'</font>').fadeIn(1000);
      // $('#messagebox').html('<font style="color:green;font-size:16px;">'+result.msg+'</font>').fadeIn(300).delay(2500).fadeOut(300,function(){
      //     $('#beClosed').click();                //模拟用户点击关闭
      //     window.location=window.location;       //刷新页面
      // });
    }else{
      $('#messagebox').html('<font style="color:red;font-size:16px;">'+result.msg+'</font>').fadeIn(1000);
    }
  }
  function error(){
    $("#messagebox").html('');
    alert('请求超时或失败，请重试');
  }
 });
</script>
</html>
<extend name="./base" />

<block name="main">

    <div class="container">
        <div class="col-md-2">
        	<include file="Public:authNav" />
        </div>
        <div class="col-md-10">
        	<div class="rtop">
        		<ul class="list-inline">
 					<if condition="ACTION_NAME eq 'index_authNav'">
 				 		<li class="blue"><a href="{:U('/AdminAuth/index_authNav')}">员工列表</a></li>
 				 		<li class=""><a href="{:U('/Manager/add')}" data-toggle="modal" data-target="#myModal">添加员工</a></li>
 				 	<else />
 				 		<!--<li class="blue"><a href="#">赋用户角色</a></li>-->
						<li class="blue"><a href="{:U('/AdminAuth/index_authNav')}">员工列表</a></li>
						<li class=""><a href="{:U('/Manager/add')}" data-toggle="modal" data-target="#myModal">添加员工</a></li>
 				 	</if>
 				 <li style="float:right">您当前所在位置：权限管理&nbsp;/&nbsp;<a href="javascript:void(0);" class="color">员工列表</a></li>
				</ul>

				<table border="0" cellpadding="0" cellspacing="0" class="table table-hover" style="border-bottom:none !important">
					<thead>
						<tr>
							<th>序号</th>
							<th>用户名</th>
							<th>真实用户名</th>
							<th>邮箱</th>
							<th>电话</th>
							<th>状态</th>
							<th>操作</th>
							<!-- <th>操作</th> -->
						</tr>
					</thead>
					<tbody style="font-size:15px;">
						<volist name="data" id="vo" key="key" mod="2">
							<tr  <eq name="mod" value="1"> style="background-color:#ddd;"</eq>>
								<td class="td1">
										{$vo.id}
								</td>
								<td class="td1">
										{$vo.name}
								</td>
								<td class="td1">
										{$vo.tname}
								</td>
								<td class="td1">
										{$vo.email}
								</td>
								<td class="td1">
										{$vo.phone}
								</td>
								<td class="td1">
									<if condition="$vo['status'] eq 1" >
										<span  style="color:green">启用</span>
									<else />
										<span style="color:red">禁用</span>
									</if>	
								</td>
								<td align="center" class="td3">
										<a href="{:U('/Manager/edit',array('id' => $vo['id']))}" class=""   data-toggle="modal" data-target="#myModal">修改</a>&nbsp;|
										<a href="{:U('AdminAuth/useredit',array('uid' => $vo['id']))}" class=""  >设置员工个人权限</a>&nbsp;|
										<a href="{:U('AdminAuth/user_point',array('uid' => $vo['id']))}" class=""   data-toggle="modal" data-target="#myModal">分配揽收点</a>&nbsp;|
										<a href="{:U('AdminAuth/transit',array('uid' => $vo['id']))}" class=""   data-toggle="modal" data-target="#myModal">分配中转路线</a>&nbsp;|
										<!-- <a href="#" class="" onclick="toDel('{$vo['id']}','/AdminAuth/delete')"  >删除</a> -->
										<!--  <a href="{:U('Auth/userdelete',array('uid'=>$vo['user_id']))}" class="btn btn-danger">{:L('Delete')}</a>-->
										<a onclick="auth(this)" url_a="{:U('AdminAuth/userdelete', array('id' => $vo['id']))}" user_name="{$vo['name']}" href="#">删除</a>	
								</td>
							</tr>
						</volist>
					</tbody>

				</table>

				<div id="pages" class="page">{$page}</div>
        	</div>
        </div>
		</div>		
<div class="foot"></div>
<script type="text/javascript">
	function ityzl_SHOW_LOAD_LAYER(){  
	    return layer.msg('努力中...', {icon: 16,shade: [0.5, '#f5f5f5'],scrollbar: false,offset: '200px', time:100000}) ;  
	}  
	function ityzl_CLOSE_LOAD_LAYER(index){  
	    layer.close(index);  
	}  
	function ityzl_SHOW_TIP_LAYER(str, url = ''){  
	    layer.msg(''+str+'',{time: 2000,offset: '200px'}); 
	    if(url){
	    	window.location = url;
	    }else{
	    	window.location.reload(); 
	    }
	} 
	
	function auth(obj){
		//var uid = $(obj).attr('uid');
		//var url_a = "{:U('AdminCollectPoint/pointdelete')}";
		//var url = url_a + '/pid/' + uid;
		var del_sn = $(obj).attr('user_name');
		var url = $(obj).attr('url_a');
		if(confirm('是否删除员工名为：'+ del_sn + ' 的信息！')){
			//window.location.href=url;

			var request;
			var i;
			ityzl_SHOW_LOAD_LAYER();
			if (window.XMLHttpRequest) {
				request = new XMLHttpRequest();
			} else {
			    request = new ActiveXObject('Microsoft.XMLHTTP');
			}
			request.onreadystatechange = function(){
				if(request.status == 200 && request.readyState == 4){
					if(request.responseText){
						var a = JSON.parse( request.responseText );
						var status = a.status;
						//alert(status);
						//alert(a.data.strstr);
						//window.location.reload();
						//alert(request.responseText);
						//alert('导入成功！');
						var str = a.data.strstr;
						ityzl_CLOSE_LOAD_LAYER(i); 
		                ityzl_SHOW_TIP_LAYER(str); 
		                document.getElementById("form1").reset();
					}else{
						ityzl_CLOSE_LOAD_LAYER(i);
					}
				}
			}
			request.open("get", url);
			//request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			request.setRequestHeader("X-Requested-With","XMLHttpRequest");
			request.send();

			
		} 
	}

</script>		
		
</block>


</body>
</html>
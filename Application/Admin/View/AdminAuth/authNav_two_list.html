<extend name="./base" />

<block name="main">

    <div class="container">
        <div class="col-md-2">
			<include file="Public:authNav" />
        </div>
        <div class="col-md-10">
        	<div class="rtop">
        		<ul class="list-inline">
 				 <if condition="ACTION_NAME eq 'authNav_two'">
 				 		<if condition="$judgment eq 1">
 				 			<li class="blue"><a href="{:U('AdminAuth/modules_add', array('id' => $id))}"   data-toggle="modal" data-target="#myModal">权限组模块名添加</a></li>
 				 			<li class="blue"><a href="{:U('AdminAuth/auth_add', array('mid' => $id))}"   data-toggle="modal" data-target="#myModal">添加权限规则</a></li>
 				 		<elseif condition="$judgment eq 2"  />
 				 		
 				 			<li class="blue"><a href="{:U('AdminAuth/auth_add', array('mid' => $id))}"   data-toggle="modal" data-target="#myModal">添加权限规则</a></li>
 				 		<elseif condition="$judgment eq 3"  />
 				 			<li class="blue"><a href="{:U('AdminAuth/modules_add', array('id' => $id))}"   data-toggle="modal" data-target="#myModal">权限组模块名添加</a></li>
 				 		</if>
 				 	<else />
 				 		<li class="blue"><a href="{:U('/AdminAuth/index_authNav_authDisplay')}">权限列表</a></li>
 				 		
 				 	</if>
 				 <li style="float:right">
 				 	您当前所在位置：
 				 	<a href="{:U('/AdminAuth/index_authNav_authDisplay')}" class="color">权限显示</a>&nbsp;/&nbsp;
				 	<volist name="top_navs" id="tn">
 				 		<if condition="$tn['pid'] eq 0">
 				 			<a href="{:U('/AdminAuth/index_authNav_authDisplay')}" class="color">{$tn['ModulesName']}</a>
 				 		
 				 		<else />
 				 			&nbsp;/&nbsp;<a href="{:U('/AdminAuth/authNav_two', array('id' => $tn['id']))}" class="color">{$tn['ModulesName']}</a>
 				 		
 				 		</if>
 				 	</volist>  
 				 </li>
				</ul>

				
					<table border="0" cellpadding="0" cellspacing="0" class="table table-hover" style="border-bottom:none !important">
						<thead>
							<tr>
								<th align="center">编号</th>
								<th align="center">规则标识</th>
								<th align="center">规则简述</th>
								<!-- <th align="center">附加条件</th> -->
								<th align="center">所属导航权限名称一级</th>
								<th align="center">所属导航权限名称二级</th>
								<th align="center">所属导航权限名称三级</th>
								<th align="center">状态</th>
								<th align="center">序号</th>
								<th align="center">操作</th>
							</tr>
						</thead>
						<volist name='data' id="vo" mod="2">
						<tr  <eq name="mod" value="1"> style="background-color:#ddd;"</eq>>
							<td align="center">{$i+$num}</td>
							<td align="center">{$vo['name']}</td>
							<td align="center">{$vo['title']}</td>
							<!-- <td align="center">{$vo['term']}</td> -->
							<td align="center">{$vo['ModulesName']}</td>
							<td align="center">{$vo['pid_two_name']}</td>
							<td align="center">{$vo['pid_three_name']}</td>
							<td align="center">
							<!-- 
								<if condition="$vo['status'] eq 1"><span class="label label-success"><i class="glyphicon glyphicon-ok"></i></span>
								<else />
									<span class="label label-danger">							
									<i class="glyphicon glyphicon-remove"></i></span>
								</if> -->
								<img src="__PUBLIC__/images/<if condition="$vo['status'] eq 1">pass.png<else />nopass.png</if>" width="20" height="20" />
							</td>
							<td align="center">{$vo['sort']}</td>
							
							<td  align="center" class="td3">
									<a href="{:U('AdminAuth/authAddEdit',array('id' => $vo['id']))}" class=""   data-toggle="modal" data-target="#myModal">修改</a>&nbsp;|
									<!--  <a href="{:U('/Auth/authAddDel',array('id'=>$vo['id']))}" class="btn btn-danger">{:L('Delete')}</a>-->
									<a onclick="stock(this)" id="{$vo['id']}" name="{$vo['name']}" url_a="{:U('AdminAuth/authAddDel', array('id' => $vo['id']))}"  href="#" class="">删除</a>
							
							</td>
						</tr>

						</volist>
						<tr>
							<td colspan='9' class="page" id="pages">{$page}</td>
						</tr>
					</table>
				
        	</div>
        </div>
		</div>		
<script type="text/javascript">
function ityzl_SHOW_LOAD_LAYER(){  
    return layer.msg('努力中...', {icon: 16,shade: [0.5, '#f5f5f5'],scrollbar: false,offset: '200px', time:100000}) ;  
}  
function ityzl_CLOSE_LOAD_LAYER(index){  
    layer.close(index);  
}  
function ityzl_SHOW_TIP_LAYER(str, url = ''){  
    layer.msg(''+str+'',{time: 2000,offset: '200px'}); 
    if(url){
    	window.location = url;
    }else{
    	window.location.reload(); 
    }
} 
	function stock(obj){
		var id = $(obj).attr('id');
		var url_a = $(obj).attr('url_a');;
		//var url = url_a + '/id/' + id;
		var url = url_a;
		var del_sn = $(obj).attr('name');
		if(confirm('是否删除权限URL为：'+ del_sn + ' 的信息！')){
			//window.location.href=url;

			var formData = new FormData();
			//formData.append("id", id);
			var request;
			if (window.XMLHttpRequest) {
				request = new XMLHttpRequest();
			} else {
			    request = new ActiveXObject('Microsoft.XMLHTTP');
			}
			var i;
			ityzl_SHOW_LOAD_LAYER();
			request.onreadystatechange = function(){
				if(request.status == 200 && request.readyState == 4){
					if(request.responseText){
						//成功返回
						var a = JSON.parse( request.responseText );
						var status = a.status;
						var str = a.data.strstr;
						var url = a.data.url;
						ityzl_CLOSE_LOAD_LAYER(i); 
						ityzl_SHOW_TIP_LAYER(str, url);
		                
					}else{
						ityzl_CLOSE_LOAD_LAYER(i);
					}
				}
			}
			request.open("post", url);
			//request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			request.setRequestHeader("X-Requested-With","XMLHttpRequest");
			request.send(formData);

			
		} 
	}

</script>

<div class="foot"></div>

</block>


</body>
</html>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">

    <style type="text/css">
        body {
            padding-top: 40px;
            padding-bottom: 40px;
            background-color: #f5f5f5;

        }

        .container{margin:0 auto;}
        .form-signin {
            max-width: 900px;
            margin-top:60px;
            background-color: #fff;
            border: 1px solid #e5e5e5;
            -webkit-border-radius: 5px;
            -moz-border-radius: 5px;
            border-radius: 5px;
            -webkit-box-shadow: 0 1px 2px rgba(0,0,0,.05);
            -moz-box-shadow: 0 1px 2px rgba(0,0,0,.05);
            box-shadow: 0 1px 2px rgba(0,0,0,.05);
        }
        .form-signin table th{height:36px;font-size:16px;line-height:36px;background:#F7F7F9;}
        .form-signin table td{height:36px;line-height:36px;font-size:14px;text-indent:2em;background:#F7F7F9;}
        .form-signin table td a{text-decoration:none;color:#000;}
        .form-signin table td a:hover{color:blue;}
        .form-signin .form-control{width:400px !important;}
        .form-signin input{display:inline-block;}
    </style>
    <link href="__PUBLIC__/css/one.css" rel="stylesheet">
    <script src="__PUBLIC__/js/jquery-1.9.1.min.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
    <script src="//cdnjs.bootcss.com/ajax/libs/html5shiv/3.6.2/html5shiv.js"></script>
    <![endif]-->
</head>
<body>

<div class="container" >
    <div class="form-signin" style="padding-top:40px;background:#F7F7F9 !important;margin-bottom:40px;margin: 0 auto;">

        <form action="{:U('Logistics/import_excel')}" method="post" class="form-inline" id="excel_runimport" name="excel_runimport" enctype="multipart/form-data">
            <table border="0" cellpadding="0" cellspacing="0" class="table" style="margin-bottom:0px;padding:0px">
                <input type="hidden" value="{$line_id}" name="line_id">
                <tr>
                    <th>请选择要导入的excel文件：</th>
                    <td>
                        <input type="file" name="file" value="" id="file_stu" required/>
                    </td>
                </tr>

                <tr>
                    <th  colspan="3" style="text-align:left !important;padding-left:580px">
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                        <button type="submit" class="btn btn-primary" id="BtnSave">提交</button>
                        <span id="messagebox" class="msgbox" style="right:200px !important;top:167px;"></span>
                    </th>
                </tr>

            </table>
        </form>

    </div>
</div>

</body>
<script src="__PUBLIC__/js/jquery.form.js"></script>
<script>

    $(function(){

        $('#excel_runimport').ajaxForm({
            beforeSubmit: checkForm,
            success: complete,
            error: error,
            dataType: 'json',
            timeout : 0,// 代表永不超时
        });

        function checkForm(){
            $("#messagebox").html('<img style="width:20px;height:20px;" src="__PUBLIC__/images/msg_loading_d.gif"/>操作中...');
            if( '' == $.trim($('#file_stu').val())){
                alert('上传文件不能为空');
                return false;
            }
        }
        function complete(result){
            if(result.status == 1){
                $('#messagebox').html('<font style="color:green;font-size:16px;">'+result.msg+'</font>').fadeIn(1000);
                // $('#messagebox').html('<font style="color:green;font-size:16px;">'+result.msg+'</font>').fadeIn(300).delay(1000).fadeOut(300,function(){
                // $('#beClosed').click();                //模拟用户点击关闭
                // window.location=window.location;       //刷新页面
                // });
            }else{
                $('#messagebox').html('<font style="color:red;font-size:16px;">'+result.msg+'</font>').fadeIn(1000);
            }
        }
        function error(){
            $("#messagebox").html('');
            alert('请求超时或失败，请重试');
        }
    });
</script>
</html>